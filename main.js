!function(){"use strict";var t={d:function(e,n){for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}};function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function n(t,n){for(var r=0;r<n.length;r++){var o=n[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(void 0,i=function(t,n){if("object"!==e(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,"string");if("object"!==e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o.key),"symbol"===e(i)?i:String(i)),o)}var i}t.d({},{y$:function(){return I},O9:function(){return q},rC:function(){return C},t1:function(){return L}});var r=function(){function t(e,n,r,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._title=e,this._link=n,this._templateSelector=r,this._handleCardClick=o}var e,r;return e=t,(r=[{key:"createCardElement",value:function(){var t=document.querySelector(this._templateSelector).content.querySelector(".element").cloneNode(!0),e=t.querySelector(".element__image"),n=t.querySelector(".element__title");return e.title=this._title,e.src=this._link,n.textContent=this._title,this._newElement=t,this._createEventListeners(),t}},{key:"_handleDelete",value:function(t){t.target.closest(".element").remove()}},{key:"_handleLike",value:function(t){t.target.classList.toggle("like_active")}},{key:"_createEventListeners",value:function(){this._newElement.querySelector(".delete-button").addEventListener("click",this._handleDelete),this._newElement.querySelector(".like").addEventListener("click",this._handleLike),this._newElement.querySelector(".element__image").addEventListener("click",this._handleCardClick)}}])&&n(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,i=function(t,e){if("object"!==o(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==o(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===o(i)?i:String(i)),r)}var i}var u=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._conf=e,this._formList=n}var e,n;return e=t,(n=[{key:"showInputError",value:function(t,e,n){var r=t.querySelector(".".concat(e.id,"-error"));e.classList.add(this._conf.inputErrorClass),r.textContent=n,r.classList.add(this._conf.errorClass)}},{key:"hideInputError",value:function(t,e){var n=t.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._conf.inputErrorClass),n.classList.remove(this._conf.errorClass),n.textContent=""}},{key:"checkInputValidity",value:function(t,e){e.validity.valid?this.hideInputError(t,e):this.showInputError(t,e,e.validationMessage)}},{key:"hasInvalidInput",value:function(t){return t.some((function(t){return!t.validity.valid}))}},{key:"toggleButtonState",value:function(t,e){this.hasInvalidInput(t)?e.classList.add(this._conf.inactiveButtonClass):e.classList.remove(this._conf.inactiveButtonClass)}},{key:"validateField",value:function(t,e,n,r){this.toggleButtonState(t,e),this.checkInputValidity(r,n)}},{key:"setEventListeners",value:function(t){var e=this,n=Array.from(t.querySelectorAll(this._conf.inputSelector)),r=t.querySelector(this._conf.submitButtonSelector);this.toggleButtonState(n,r),n.forEach((function(o){o.addEventListener("input",(function(){e.validateField(n,r,o,t)}))}))}},{key:"enableValidation",value:function(){var t=this;this._formList.forEach((function(e){e.addEventListener("submit",(function(t){t.preventDefault()})),t.setEventListeners(e)}))}}])&&i(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function a(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==c(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===c(o)?o:String(o)),r)}var o}var l=function(){function t(e,n){var r=e.items,o=e.renderer;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._items=r,this._renderer=o,this._container=document.querySelector(n)}var e,n;return e=t,(n=[{key:"renderItems",value:function(){var t=this;this._items.forEach((function(e){t._renderer(e)}))}},{key:"addItem",value:function(t){this._container.prepend(t)}}])&&a(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==s(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===s(o)?o:String(o)),r)}var o}var p=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._popup=document.querySelector(e)}var e,n;return e=t,(n=[{key:"open",value:function(){this._popup.showModal()}},{key:"close",value:function(){var t=this;this._popup.setAttribute("closing",!0),this._popup.addEventListener("animationend",(function(){t._popup.removeAttribute("closing"),t._popup.close()}),{once:!0})}},{key:"closeOnOutsideClick",value:function(t){t.target===this._popup&&this.close(t)}},{key:"_handleEscClose",value:function(t){"Escape"===t.key&&this.close(t)}},{key:"setEventListeners",value:function(){var t=this;this._popup.querySelector(".close-button").addEventListener("click",(function(e){t.close(e)})),this._popup.addEventListener("click",(function(e){t.closeOnOutsideClick(e)})),this._popup.addEventListener("keypress",(function(e){t._handleEscClose(e)}))}}])&&f(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function y(t){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},y(t)}function m(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==y(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===y(o)?o:String(o)),r)}var o}function v(){return v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=d(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},v.apply(this,arguments)}function b(t,e){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},b(t,e)}function d(t){return d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},d(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&b(t,e)}(u,t);var e,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=d(r);if(o){var n=d(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===y(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function u(t,e){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(n=i.call(this,e))._submitForm=t,n}return e=u,(n=[{key:"_getInputValues",value:function(){var t=this._popup.querySelectorAll(".input"),e={};return t.forEach((function(t){e[t.id]=t.value})),e}},{key:"close",value:function(t){v(d(u.prototype),"close",this).call(this,t);var e=document.querySelector("#place-input"),n=document.querySelector("#link-input");e.value="",n.value=""}},{key:"setEventListeners",value:function(){var t=this;v(d(u.prototype),"setEventListeners",this).call(this),this._popup.classList.value.includes("edit-popup")?document.querySelector(".edit-button").addEventListener("click",(function(){t.open()})):document.querySelector(".add-button").addEventListener("click",(function(){t.open()})),this._popup.querySelector(".save-button").addEventListener("click",(function(e){t._submitForm(e),e.preventDefault()}))}}])&&m(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(p);function _(t){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_(t)}function S(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==_(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==_(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===_(o)?o:String(o)),r)}var o}var w=function(){function t(e){var n=e.userName,r=e.userJob;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._name=n,this._job=r}var e,n;return e=t,(n=[{key:"getUserInfo",value:function(){return{userName:this._name,userjob:this._job}}},{key:"setUserInfo",value:function(t,e){this._name=t,this._job=e,C.textContent=t,L.textContent=e,q.value=t,I.value=e}}])&&S(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function g(t){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(t)}function E(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==g(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!==g(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(r.key),"symbol"===g(o)?o:String(o)),r)}var o}function k(t,e){return k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},k(t,e)}function j(t){return j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},j(t)}var O=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&k(t,e)}(u,t);var e,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=j(r);if(o){var n=j(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===g(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function u(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),i.call(this,t)}return e=u,(n=[{key:"open",value:function(t){var e=document.querySelector(".image-popup__title");document.querySelector(".image-popup__image").src=t.target.src,e.textContent=t.target.title,this._popup.showModal()}}])&&E(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),u}(p),P=Array.from(document.querySelectorAll(".form")),C=document.querySelector(".profile__title"),L=document.querySelector(".profile__subtitle"),q=document.querySelector("#name-input"),I=document.querySelector("#about-input"),B=new l({items:[{name:"Valle de Yosemite",link:"https://practicum-content.s3.us-west-1.amazonaws.com/new-markets/WEB_sprint_5/ES/yosemite.jpg"},{name:"Lago Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/new-markets/WEB_sprint_5/ES/lake-louise.jpg"},{name:"Montañas Calvas",link:"https://practicum-content.s3.us-west-1.amazonaws.com/new-markets/WEB_sprint_5/ES/bald-mountains.jpg"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/new-markets/WEB_sprint_5/ES/latemar.jpg"},{name:"Parque Nacional de la Vanoise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/new-markets/WEB_sprint_5/ES/vanoise.jpg"},{name:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/new-markets/WEB_sprint_5/ES/lago.jpg"}],renderer:V},".elements"),T=new h((function(t){var e=T._getInputValues();V({name:e["place-input"],link:e["link-input"]}),T.close(t)}),".add-popup"),R=new h((function(t){x.setUserInfo(q.value,I.value),R.close(t)}),".edit-popup"),x=new w({userName:C.textContent,userJob:L.textContent});function V(t){var e=t.name,n=t.link,o=new r(e,n,".element-template",(function(t){var e=new O(".image-popup");e.setEventListeners(),e.open(t)}));B.addItem(o.createCardElement())}x.setUserInfo(C.textContent,L.textContent),B.renderItems(),new u({formSelector:".form",inputSelector:".input",submitButtonSelector:".save-button",inactiveButtonClass:"save-button_inactive",inputErrorClass:"input_type_error",errorClass:"form__input-error_active"},P).enableValidation(),T.setEventListeners(),R.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QkMsU0FBVU8sRUFBWTVGLFlBQ3RCc0YsUUFBU08sRUFBZ0I3RixjQVkzQixTQUFTbUcsRUFBV2pELEdBQWlCLElBQWR3QyxFQUFJeEMsRUFBSndDLEtBQU01RyxFQUFJb0UsRUFBSnBFLEtBQ3JCMkgsRUFBVSxJQUFJN0gsRUFBSzhHLEVBQU01RyxFQUFNLHFCQUFxQixTQUFDcUIsR0FDekQsSUFBTXVHLEVBQWEsSUFBSVYsRUFBZSxnQkFDdENVLEVBQVcxRCxvQkFDWDBELEVBQVd2QixLQUFLaEYsRUFDbEIsSUFDQStGLEVBQVFTLFFBQVFGLEVBQVFHLG9CQUMxQixDQWhCQUwsRUFBU0MsWUFBWVosRUFBWTVGLFlBQWE2RixFQUFnQjdGLGFBQzlEa0csRUFBUVcsY0F1Q2MsSUFBSWpHLEVBQ3hCLENBQ0VrRyxhQUFjLFFBQ2RwRSxjQUFlLFNBQ2ZDLHFCQUFzQixlQUN0QlIsb0JBQXFCLHVCQUNyQlgsZ0JBQWlCLG1CQUNqQkMsV0FBWSw0QkFFZFgsR0FFWWlHLG1CQUNkWCxFQUFTcEQsb0JBQ1RzRCxFQUFVdEQsbUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80X2VzcC93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80X2VzcC93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNF9lc3Avd2VicGFjay9ydW50aW1lL2hhc093blByb3BlcnR5IHNob3J0aGFuZCIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80X2VzcC8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNF9lc3AvLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzRfZXNwLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80X2VzcC8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzRfZXNwLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80X2VzcC8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzRfZXNwLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNF9lc3AvLi9zcmMvcGFnZXMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIGRlZmluaXRpb24pIHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqLCBwcm9wKSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKTsgfSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3Rvcih0aXRsZSwgbGluaywgdGVtcGxhdGVTZWxlY3RvciwgaGFuZGxlQ2FyZENsaWNrKSB7XG4gICAgdGhpcy5fdGl0bGUgPSB0aXRsZTtcbiAgICB0aGlzLl9saW5rID0gbGluaztcbiAgICB0aGlzLl90ZW1wbGF0ZVNlbGVjdG9yID0gdGVtcGxhdGVTZWxlY3RvcjtcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyBhIENhcmQgZWxlbWVudCB3aXRoIHRoZSBnaXZlbiB0aXRsZSwgaW1hZ2UgbGluayBhbmRcbiAgICogdGVtcGxhdGUgc2VsZWN0b3IuXG4gICAqIEByZXR1cm5zIEEgQ2FyZCBlbGVtZW50IHdpdGggYWxsIHRoZSByZXF1aXJlZCBpbmZvLlxuICAgKi9cbiAgY3JlYXRlQ2FyZEVsZW1lbnQoKSB7XG4gICAgY29uc3QgZWxlbWVudFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIHRoaXMuX3RlbXBsYXRlU2VsZWN0b3JcbiAgICApLmNvbnRlbnQ7XG4gICAgY29uc3QgbmV3RWxlbWVudCA9IGVsZW1lbnRUZW1wbGF0ZVxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudFwiKVxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcbiAgICBjb25zdCBuZXdFbGVtZW50SW1hZ2UgPSBuZXdFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWxlbWVudF9faW1hZ2VcIik7XG4gICAgY29uc3QgbmV3RWxlbWVudFRpdGxlID0gbmV3RWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX3RpdGxlXCIpO1xuXG4gICAgbmV3RWxlbWVudEltYWdlLnRpdGxlID0gdGhpcy5fdGl0bGU7XG4gICAgbmV3RWxlbWVudEltYWdlLnNyYyA9IHRoaXMuX2xpbms7XG4gICAgbmV3RWxlbWVudFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fdGl0bGU7XG4gICAgdGhpcy5fbmV3RWxlbWVudCA9IG5ld0VsZW1lbnQ7XG4gICAgdGhpcy5fY3JlYXRlRXZlbnRMaXN0ZW5lcnMoKTtcbiAgICByZXR1cm4gbmV3RWxlbWVudDtcbiAgfVxuXG4gIC8qKlxuICAgKiBEZWxldGVzIHRoZSBlbGVtZW50IG9uIHdoaWNoIHRoZSBkZWxldGUgYnV0dG9uIHdhcyBjbGlja2VkLlxuICAgKiBAcGFyYW0geyp9IGV2dCBUaGUgY2xpY2sgZXZlbnQuXG4gICAqL1xuICBfaGFuZGxlRGVsZXRlKGV2dCkge1xuICAgIGV2dC50YXJnZXQuY2xvc2VzdChcIi5lbGVtZW50XCIpLnJlbW92ZSgpO1xuICB9XG5cbiAgLyoqXG4gICAqIFRvZ2dsZXMgdGhlIFwibGlrZV9hY3RpdmVcIiBjbGFzcy5cbiAgICogQHBhcmFtIHsqfSBldnQgVGhlIGNsaWNrIGV2ZW50LlxuICAgKi9cbiAgX2hhbmRsZUxpa2UoZXZ0KSB7XG4gICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKFwibGlrZV9hY3RpdmVcIik7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyBlYWNoIGluZGl2aWR1YWwgbGlzdGVuZXIgZm9yIGVhY2ggY2FyZCBjb21wb25lbnQuXG4gICAqL1xuICBfY3JlYXRlRXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgY29uc3QgYnRuRGVsZXRlID0gdGhpcy5fbmV3RWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmRlbGV0ZS1idXR0b25cIik7XG4gICAgYnRuRGVsZXRlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVEZWxldGUpO1xuXG4gICAgY29uc3QgYnRuTGlrZSA9IHRoaXMuX25ld0VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5saWtlXCIpO1xuICAgIGJ0bkxpa2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZUxpa2UpO1xuXG4gICAgY29uc3QgZWxlbWVudEltYWdlID0gdGhpcy5fbmV3RWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmVsZW1lbnRfX2ltYWdlXCIpO1xuICAgIGVsZW1lbnRJbWFnZS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlQ2FyZENsaWNrKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKGNvbmYsIGZvcm1MaXN0KSB7XG4gICAgdGhpcy5fY29uZiA9IGNvbmY7XG4gICAgdGhpcy5fZm9ybUxpc3QgPSBmb3JtTGlzdDtcbiAgfVxuXG4gIHNob3dJbnB1dEVycm9yKGZvcm1FbGVtZW50LCBpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSkge1xuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IGZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9jb25mLmlucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2NvbmYuZXJyb3JDbGFzcyk7XG4gIH1cblxuICBoaWRlSW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50KSB7XG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2NvbmYuaW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9jb25mLmVycm9yQ2xhc3MpO1xuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XG4gIH1cblxuICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCkge1xuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLnNob3dJbnB1dEVycm9yKFxuICAgICAgICBmb3JtRWxlbWVudCxcbiAgICAgICAgaW5wdXRFbGVtZW50LFxuICAgICAgICBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2VcbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuaGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCk7XG4gICAgfVxuICB9XG5cbiAgaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkge1xuICAgIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcbiAgICB9KTtcbiAgfVxuXG4gIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCkge1xuICAgIGlmICh0aGlzLmhhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XG4gICAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fY29uZi5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2NvbmYuaW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgfVxuICB9XG5cbiAgdmFsaWRhdGVGaWVsZChpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGlucHV0RWxlbWVudCwgZm9ybUVsZW1lbnQpIHtcbiAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCk7XG4gICAgdGhpcy5jaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCk7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycyhmb3JtRWxlbWVudCkge1xuICAgIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20oXG4gICAgICBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2NvbmYuaW5wdXRTZWxlY3RvcilcbiAgICApO1xuICAgIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgdGhpcy5fY29uZi5zdWJtaXRCdXR0b25TZWxlY3RvclxuICAgICk7XG4gICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQpO1xuXG4gICAgaW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMudmFsaWRhdGVGaWVsZChpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGlucHV0RWxlbWVudCwgZm9ybUVsZW1lbnQpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2Zvcm1MaXN0LmZvckVhY2goKGZvcm1FbGVtZW50KSA9PiB7XG4gICAgICBmb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGZ1bmN0aW9uIChldnQpIHtcbiAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB9KTtcbiAgICAgIHRoaXMuc2V0RXZlbnRMaXN0ZW5lcnMoZm9ybUVsZW1lbnQpO1xuICAgIH0pO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XG4gIH1cblxuICByZW5kZXJJdGVtcygpIHtcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcbiAgICB9KTtcbiAgfVxuICBhZGRJdGVtKGl0ZW0pIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChpdGVtKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICB9XG5cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9wb3B1cC5zaG93TW9kYWwoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDbG9zZXMgdGhlIG9wZW4gcG9wdXAgd2l0aCBhIHNtb290aCB0cmFuc2l0aW9uLlxuICAgKi9cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXAuc2V0QXR0cmlidXRlKFwiY2xvc2luZ1wiLCB0cnVlKTtcbiAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgXCJhbmltYXRpb25lbmRcIixcbiAgICAgICgpID0+IHtcbiAgICAgICAgdGhpcy5fcG9wdXAucmVtb3ZlQXR0cmlidXRlKFwiY2xvc2luZ1wiKTtcbiAgICAgICAgdGhpcy5fcG9wdXAuY2xvc2UoKTtcbiAgICAgIH0sXG4gICAgICB7IG9uY2U6IHRydWUgfVxuICAgICk7XG4gIH1cblxuICAvKipcbiAgICogQ2xvc2VzIHRoZSBwb3B1cCB3aW5kb3cgd2hlbiBjbGlja2luZyBvdXRzaWRlLlxuICAgKlxuICAgKiBAcGFyYW0geyp9IGV2dCBUaGUgY2xpY2sgZXZlbnQuXG4gICAqL1xuICBjbG9zZU9uT3V0c2lkZUNsaWNrKGV2dCkge1xuICAgIGlmIChldnQudGFyZ2V0ID09PSB0aGlzLl9wb3B1cCkge1xuICAgICAgdGhpcy5jbG9zZShldnQpO1xuICAgIH1cbiAgfVxuXG4gIF9oYW5kbGVFc2NDbG9zZShldnQpIHtcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZShldnQpO1xuICAgIH1cbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIGNvbnN0IGNsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5jbG9zZS1idXR0b25cIik7XG4gICAgY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IHtcbiAgICAgIHRoaXMuY2xvc2UoZXZ0KTtcbiAgICB9KTtcblxuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XG4gICAgICB0aGlzLmNsb3NlT25PdXRzaWRlQ2xpY2soZXZ0KTtcbiAgICB9KTtcblxuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlwcmVzc1wiLCAoZXZ0KSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZShldnQpO1xuICAgIH0pO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IoY2FsbGJhY2tGdW5jdGlvbiwgcG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX3N1Ym1pdEZvcm0gPSBjYWxsYmFja0Z1bmN0aW9uO1xuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIGNvbnN0IGlucHV0RmllbGRzID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvckFsbChcIi5pbnB1dFwiKTtcbiAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHt9O1xuXG4gICAgaW5wdXRGaWVsZHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIGlucHV0VmFsdWVzW2lucHV0LmlkXSA9IGlucHV0LnZhbHVlO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIGlucHV0VmFsdWVzO1xuICB9XG5cbiAgY2xvc2UoZXZ0KSB7XG4gICAgc3VwZXIuY2xvc2UoZXZ0KTtcbiAgICBjb25zdCBwbGFjZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwbGFjZS1pbnB1dFwiKTtcbiAgICBjb25zdCBsaW5rSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2xpbmstaW5wdXRcIik7XG5cbiAgICBwbGFjZUlucHV0LnZhbHVlID0gXCJcIjtcbiAgICBsaW5rSW5wdXQudmFsdWUgPSBcIlwiO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICBpZiAodGhpcy5fcG9wdXAuY2xhc3NMaXN0LnZhbHVlLmluY2x1ZGVzKFwiZWRpdC1wb3B1cFwiKSkge1xuICAgICAgY29uc3QgZWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZWRpdC1idXR0b25cIik7XG4gICAgICBlZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMub3BlbigpO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGFkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuYWRkLWJ1dHRvblwiKTtcbiAgICAgIGFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLm9wZW4oKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IHN1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIuc2F2ZS1idXR0b25cIik7XG4gICAgc3VibWl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XG4gICAgICB0aGlzLl9zdWJtaXRGb3JtKGV2dCk7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IHtcbiAgcHJvZmlsZU5hbWUsXG4gIHByb2ZpbGVTdWJ0aXRsZSxcbiAgbmFtZUlucHV0LFxuICBhYm91dElucHV0LFxufSBmcm9tIFwiLi4vcGFnZXMvaW5kZXguanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3Rvcih7IHVzZXJOYW1lLCB1c2VySm9iIH0pIHtcbiAgICB0aGlzLl9uYW1lID0gdXNlck5hbWU7XG4gICAgdGhpcy5fam9iID0gdXNlckpvYjtcbiAgfVxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4geyB1c2VyTmFtZTogdGhpcy5fbmFtZSwgdXNlcmpvYjogdGhpcy5fam9iIH07XG4gIH1cblxuICBzZXRVc2VySW5mbyhuYW1lLCBqb2IpIHtcbiAgICB0aGlzLl9uYW1lID0gbmFtZTtcbiAgICB0aGlzLl9qb2IgPSBqb2I7XG4gICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgIHByb2ZpbGVTdWJ0aXRsZS50ZXh0Q29udGVudCA9IGpvYjtcbiAgICBuYW1lSW5wdXQudmFsdWUgPSBuYW1lO1xuICAgIGFib3V0SW5wdXQudmFsdWUgPSBqb2I7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNob3dzIGEgYmlnZ2VyIHZlcnNpb24gb2YgdGhlIGNsaWNrZWQgaW1hZ2Ugb2YgdGhlIGVsZW1lbnQuXG4gICAqIEBwYXJhbSB7Kn0gZXZ0IFRoZSBjbGljayBldmVudFxuICAgKi9cbiAgb3BlbihldnQpIHtcbiAgICBjb25zdCBpbWFnZVRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5pbWFnZS1wb3B1cF9fdGl0bGVcIik7XG4gICAgY29uc3QgaW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmltYWdlLXBvcHVwX19pbWFnZVwiKTtcbiAgICBpbWFnZS5zcmMgPSBldnQudGFyZ2V0LnNyYztcbiAgICBpbWFnZVRpdGxlLnRleHRDb250ZW50ID0gZXZ0LnRhcmdldC50aXRsZTtcblxuICAgIHRoaXMuX3BvcHVwLnNob3dNb2RhbCgpO1xuICB9XG59XG4iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcblxuY29uc3QgZm9ybUxpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZm9ybVwiKSk7XG5jb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fdGl0bGVcIik7XG5jb25zdCBwcm9maWxlU3VidGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3N1YnRpdGxlXCIpO1xuY29uc3QgbmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNuYW1lLWlucHV0XCIpO1xuY29uc3QgYWJvdXRJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWJvdXQtaW5wdXRcIik7XG5jb25zdCBpbml0aWFsQ2FyZHMgPSBbXG4gIHtcbiAgICBuYW1lOiBcIlZhbGxlIGRlIFlvc2VtaXRlXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL25ldy1tYXJrZXRzL1dFQl9zcHJpbnRfNS9FUy95b3NlbWl0ZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGFnbyBMb3Vpc2VcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vbmV3LW1hcmtldHMvV0VCX3NwcmludF81L0VTL2xha2UtbG91aXNlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJNb250YcOxYXMgQ2FsdmFzXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL25ldy1tYXJrZXRzL1dFQl9zcHJpbnRfNS9FUy9iYWxkLW1vdW50YWlucy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9uZXctbWFya2V0cy9XRUJfc3ByaW50XzUvRVMvbGF0ZW1hci5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiUGFycXVlIE5hY2lvbmFsIGRlIGxhIFZhbm9pc2VcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vbmV3LW1hcmtldHMvV0VCX3NwcmludF81L0VTL3Zhbm9pc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL25ldy1tYXJrZXRzL1dFQl9zcHJpbnRfNS9FUy9sYWdvLmpwZ1wiLFxuICB9LFxuXTtcbmNvbnN0IHNlY3Rpb24gPSBuZXcgU2VjdGlvbihcbiAgeyBpdGVtczogaW5pdGlhbENhcmRzLCByZW5kZXJlcjogbG9hZEVsZW1lbnQgfSxcbiAgXCIuZWxlbWVudHNcIlxuKTtcbmNvbnN0IGFkZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oaGFuZGxlRWxlbWVudEZvcm1TdWJtaXQsIFwiLmFkZC1wb3B1cFwiKTtcbmNvbnN0IGVkaXRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0LCBcIi5lZGl0LXBvcHVwXCIpO1xuXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XG4gIHVzZXJOYW1lOiBwcm9maWxlTmFtZS50ZXh0Q29udGVudCxcbiAgdXNlckpvYjogcHJvZmlsZVN1YnRpdGxlLnRleHRDb250ZW50LFxufSk7XG5cbnVzZXJJbmZvLnNldFVzZXJJbmZvKHByb2ZpbGVOYW1lLnRleHRDb250ZW50LCBwcm9maWxlU3VidGl0bGUudGV4dENvbnRlbnQpO1xuc2VjdGlvbi5yZW5kZXJJdGVtcygpO1xuXG4vKipcbiAqIExvYWRzIGFuIGVsZW1lbnQgaW4gdGhlIGVsZW1lbnQgc2VjdGlvbi5cbiAqXG4gKiBAcGFyYW0geyp9IGVsZW1lbnRUaXRsZSBUaGUgZWxlbWVudCdzIHRpdGxlLlxuICogQHBhcmFtIHsqfSBpbWFnZUxpbmsgVGhlIGVsZW1lbnQncyBpbWFnZS5cbiAqL1xuZnVuY3Rpb24gbG9hZEVsZW1lbnQoeyBuYW1lLCBsaW5rIH0pIHtcbiAgY29uc3QgbmV3Q2FyZCA9IG5ldyBDYXJkKG5hbWUsIGxpbmssIFwiLmVsZW1lbnQtdGVtcGxhdGVcIiwgKGV2dCkgPT4ge1xuICAgIGNvbnN0IGltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIuaW1hZ2UtcG9wdXBcIik7XG4gICAgaW1hZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIGltYWdlUG9wdXAub3BlbihldnQpO1xuICB9KTtcbiAgc2VjdGlvbi5hZGRJdGVtKG5ld0NhcmQuY3JlYXRlQ2FyZEVsZW1lbnQoKSk7XG59XG5cbi8qKlxuICogSGFuZGxlcyB0aGUgZm9ybSBzdWJtaXQgZm9yIHRoZSBwcm9maWxlIGNhc2UuXG4gKiBAcGFyYW0geyp9IGV2dCBUaGUgZm9ybSdzIHN1Ym1pdCBldmVudC5cbiAqL1xuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQoZXZ0KSB7XG4gIHVzZXJJbmZvLnNldFVzZXJJbmZvKG5hbWVJbnB1dC52YWx1ZSwgYWJvdXRJbnB1dC52YWx1ZSk7XG4gIGVkaXRQb3B1cC5jbG9zZShldnQpO1xufVxuXG4vKipcbiAqIEhhbmRsZXMgdGhlIGZvcm0gc3VibWl0IGNhc2UgZm9yIHRoZSBlbGVtZW50IGNhc2UuXG4gKiBAcGFyYW0geyp9IGV2dCBUaGUgZm9ybSdzIHN1Ym1pdCBldmVudC5cbiAqL1xuZnVuY3Rpb24gaGFuZGxlRWxlbWVudEZvcm1TdWJtaXQoZXZ0KSB7XG4gIGNvbnN0IGlucHV0VmFsdWVzID0gYWRkUG9wdXAuX2dldElucHV0VmFsdWVzKCk7XG4gIGxvYWRFbGVtZW50KHtcbiAgICBuYW1lOiBpbnB1dFZhbHVlc1tcInBsYWNlLWlucHV0XCJdLFxuICAgIGxpbms6IGlucHV0VmFsdWVzW1wibGluay1pbnB1dFwiXSxcbiAgfSk7XG4gIGFkZFBvcHVwLmNsb3NlKGV2dCk7XG59XG5cbmNvbnN0IGZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcbiAge1xuICAgIGZvcm1TZWxlY3RvcjogXCIuZm9ybVwiLFxuICAgIGlucHV0U2VsZWN0b3I6IFwiLmlucHV0XCIsXG4gICAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnNhdmUtYnV0dG9uXCIsXG4gICAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJzYXZlLWJ1dHRvbl9pbmFjdGl2ZVwiLFxuICAgIGlucHV0RXJyb3JDbGFzczogXCJpbnB1dF90eXBlX2Vycm9yXCIsXG4gICAgZXJyb3JDbGFzczogXCJmb3JtX19pbnB1dC1lcnJvcl9hY3RpdmVcIixcbiAgfSxcbiAgZm9ybUxpc3Rcbik7XG5mb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcbmFkZFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5lZGl0UG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuZXhwb3J0IHsgcHJvZmlsZU5hbWUsIHByb2ZpbGVTdWJ0aXRsZSwgbmFtZUlucHV0LCBhYm91dElucHV0IH07XG4iXSwibmFtZXMiOlsiX193ZWJwYWNrX3JlcXVpcmVfXyIsImV4cG9ydHMiLCJkZWZpbml0aW9uIiwia2V5IiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsIm9iaiIsInByb3AiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJDYXJkIiwidGl0bGUiLCJsaW5rIiwidGVtcGxhdGVTZWxlY3RvciIsImhhbmRsZUNhcmRDbGljayIsIl9jbGFzc0NhbGxDaGVjayIsInRoaXMiLCJfdGl0bGUiLCJfbGluayIsIl90ZW1wbGF0ZVNlbGVjdG9yIiwiX2hhbmRsZUNhcmRDbGljayIsInZhbHVlIiwibmV3RWxlbWVudCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJuZXdFbGVtZW50SW1hZ2UiLCJuZXdFbGVtZW50VGl0bGUiLCJzcmMiLCJ0ZXh0Q29udGVudCIsIl9uZXdFbGVtZW50IiwiX2NyZWF0ZUV2ZW50TGlzdGVuZXJzIiwiZXZ0IiwidGFyZ2V0IiwiY2xvc2VzdCIsInJlbW92ZSIsImNsYXNzTGlzdCIsInRvZ2dsZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlRGVsZXRlIiwiX2hhbmRsZUxpa2UiLCJGb3JtVmFsaWRhdG9yIiwiY29uZiIsImZvcm1MaXN0IiwiX2NvbmYiLCJfZm9ybUxpc3QiLCJmb3JtRWxlbWVudCIsImlucHV0RWxlbWVudCIsImVycm9yTWVzc2FnZSIsImVycm9yRWxlbWVudCIsImNvbmNhdCIsImlkIiwiYWRkIiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsInZhbGlkaXR5IiwidmFsaWQiLCJoaWRlSW5wdXRFcnJvciIsInNob3dJbnB1dEVycm9yIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJpbnB1dExpc3QiLCJzb21lIiwiYnV0dG9uRWxlbWVudCIsImhhc0ludmFsaWRJbnB1dCIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImNoZWNrSW5wdXRWYWxpZGl0eSIsIl90aGlzIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImZvckVhY2giLCJ2YWxpZGF0ZUZpZWxkIiwiX3RoaXMyIiwicHJldmVudERlZmF1bHQiLCJzZXRFdmVudExpc3RlbmVycyIsIlNlY3Rpb24iLCJfcmVmIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsIml0ZW0iLCJwcmVwZW5kIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwIiwic2hvd01vZGFsIiwic2V0QXR0cmlidXRlIiwicmVtb3ZlQXR0cmlidXRlIiwiY2xvc2UiLCJvbmNlIiwiY2xvc2VPbk91dHNpZGVDbGljayIsIl9oYW5kbGVFc2NDbG9zZSIsIlBvcHVwV2l0aEZvcm0iLCJfUG9wdXAiLCJfaW5oZXJpdHMiLCJfc3VwZXIiLCJjYWxsYmFja0Z1bmN0aW9uIiwiX3N1Ym1pdEZvcm0iLCJpbnB1dEZpZWxkcyIsImlucHV0VmFsdWVzIiwiaW5wdXQiLCJfZ2V0IiwiX2dldFByb3RvdHlwZU9mIiwicGxhY2VJbnB1dCIsImxpbmtJbnB1dCIsImluY2x1ZGVzIiwib3BlbiIsIlVzZXJJbmZvIiwidXNlck5hbWUiLCJ1c2VySm9iIiwiX25hbWUiLCJfam9iIiwidXNlcmpvYiIsIm5hbWUiLCJqb2IiLCJwcm9maWxlTmFtZSIsInByb2ZpbGVTdWJ0aXRsZSIsIm5hbWVJbnB1dCIsImFib3V0SW5wdXQiLCJQb3B1cFdpdGhJbWFnZSIsImltYWdlVGl0bGUiLCJzZWN0aW9uIiwibG9hZEVsZW1lbnQiLCJhZGRQb3B1cCIsIl9nZXRJbnB1dFZhbHVlcyIsImVkaXRQb3B1cCIsInVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJuZXdDYXJkIiwiaW1hZ2VQb3B1cCIsImFkZEl0ZW0iLCJjcmVhdGVDYXJkRWxlbWVudCIsInJlbmRlckl0ZW1zIiwiZm9ybVNlbGVjdG9yIiwiZW5hYmxlVmFsaWRhdGlvbiJdLCJzb3VyY2VSb290IjoiIn0=